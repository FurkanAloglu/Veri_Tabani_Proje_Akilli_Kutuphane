<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/smart_library/src/main/java/com/example/smart_library/service/PenaltyService.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/smart_library/src/main/java/com/example/smart_library/service/PenaltyService.java" />
              <option name="originalContent" value="package com.example.smart_library.service;&#10;&#10;import org.springframework.stereotype.Service;&#10;import com.example.smart_library.repository.PenaltyRepository;&#10;import com.example.smart_library.repository.BorrowingRepository;&#10;import com.example.smart_library.model.Penalty;&#10;import com.example.smart_library.model.Borrowing;&#10;import com.example.smart_library.dto.penalty.PenaltyRequest;&#10;import com.example.smart_library.dto.penalty.PenaltyResponse;&#10;import lombok.RequiredArgsConstructor;&#10;import java.util.Optional;&#10;import java.util.List;&#10;import java.util.UUID;&#10;import java.util.stream.Collectors;&#10;&#10;@Service&#10;@RequiredArgsConstructor&#10;public class PenaltyService{&#10;    private final PenaltyRepository penaltyRepository;&#10;    private final BorrowingRepository borrowingRepository;&#10;&#10;    public List&lt;PenaltyResponse&gt; findAll(){&#10;        return penaltyRepository.findAll().stream().map(this::toResponse).collect(Collectors.toList());&#10;    }&#10;&#10;    public PenaltyResponse save(PenaltyRequest request){&#10;        Penalty penalty = new Penalty();&#10;        penalty.setPenaltyFee(request.getPenaltyFee());&#10;        penalty.setIsPaid(request.getIsPaid());&#10;        penalty.setPaymentDate(request.getPaymentDate());&#10;        Borrowing borrowing = borrowingRepository.findById(request.getBorrowingId()).orElse(null);&#10;        penalty.setBorrowing(borrowing);&#10;        Penalty saved = penaltyRepository.save(penalty);&#10;        return toResponse(saved);&#10;    }&#10;&#10;    public Optional&lt;PenaltyResponse&gt; findById(UUID id){&#10;        return penaltyRepository.findById(id).map(this::toResponse);&#10;    }&#10;&#10;    public void deleteById(UUID id){&#10;        penaltyRepository.deleteById(id);&#10;    }&#10;&#10;    private PenaltyResponse toResponse(Penalty p){&#10;        return PenaltyResponse.builder()&#10;                .id(p.getPenaltyId())&#10;                .penaltyFee(p.getPenaltyFee())&#10;                .isPaid(p.isPaid())&#10;                .paymentDate(p.getPaymentDate())&#10;                .borrowingId(p.getBorrowing() != null ? p.getBorrowing().getBorrowID() : null)&#10;                .build();&#10;    }&#10;&#10;}&#10;" />
              <option name="updatedContent" value="package com.example.smart_library.service;&#10;&#10;import org.springframework.stereotype.Service;&#10;import com.example.smart_library.repository.PenaltyRepository;&#10;import com.example.smart_library.repository.BorrowingRepository;&#10;import com.example.smart_library.model.Penalty;&#10;import com.example.smart_library.model.Borrowing;&#10;import com.example.smart_library.dto.penalty.PenaltyRequest;&#10;import com.example.smart_library.dto.penalty.PenaltyResponse;&#10;import lombok.RequiredArgsConstructor;&#10;import java.util.Optional;&#10;import java.util.List;&#10;import java.util.UUID;&#10;import java.util.stream.Collectors;&#10;&#10;@Service&#10;@RequiredArgsConstructor&#10;public class PenaltyService{&#10;    private final PenaltyRepository penaltyRepository;&#10;    private final BorrowingRepository borrowingRepository;&#10;&#10;    public List&lt;PenaltyResponse&gt; findAll(){&#10;        return penaltyRepository.findAll().stream().map(this::toResponse).collect(Collectors.toList());&#10;    }&#10;&#10;    public PenaltyResponse save(PenaltyRequest request){&#10;        Penalty penalty = new Penalty();&#10;        penalty.setPenaltyFee(request.getPenaltyFee());&#10;        penalty.setPaid(request.getIsPaid() != null ? request.getIsPaid() : false);&#10;        penalty.setPaymentDate(request.getPaymentDate());&#10;        Borrowing borrowing = borrowingRepository.findById(request.getBorrowingId()).orElse(null);&#10;        penalty.setBorrowing(borrowing);&#10;        Penalty saved = penaltyRepository.save(penalty);&#10;        return toResponse(saved);&#10;    }&#10;&#10;    public Optional&lt;PenaltyResponse&gt; findById(UUID id){&#10;        return penaltyRepository.findById(id).map(this::toResponse);&#10;    }&#10;&#10;    public void deleteById(UUID id){&#10;        penaltyRepository.deleteById(id);&#10;    }&#10;&#10;    private PenaltyResponse toResponse(Penalty p){&#10;        return PenaltyResponse.builder()&#10;                .id(p.getPenaltyId())&#10;                .penaltyFee(p.getPenaltyFee())&#10;                .isPaid(p.isPaid())&#10;                .paymentDate(p.getPaymentDate())&#10;                .borrowingId(p.getBorrowing() != null ? p.getBorrowing().getBorrowID() : null)&#10;                .build();&#10;    }&#10;&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>